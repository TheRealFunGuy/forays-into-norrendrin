			/*
	(figure out crit stuff. any before-damage effects? special messages?)
	(then deal damage)
	(then look for post-damage crit effects and other on-hit effects. most of these will require the target to still be alive.)
		
	(oh! knockback or teleportation effects must now update a "position of target" var, to guarantee that you apply on-hits to the right enemy)
	
	foreach onHitEffect? checks each time.
*/


first, anything that resisted slashing will have a chance to dull bladed weapons instead, by checking explicitly.
bloats will check for maces.
mud elemental will check for NORMAL now, i think, since it resists all melee damage. (things like light sensitivity are NORMAL too - is this a problem?)
and anything that resisted bashing...will no longer resist bashing. (maybe increase its HP to make the sword better? nah.)




-i broke chests. they don't give enchantments yet.
-broke save/load, of course
-make holiness percentage instead of straight damage - if it even exists
-broke updateOnEquip and removed it from equipment switching.
-realign descriptions for enchantments and magic items?
-don't generate more than 10 magic items per game.
-all of the "check for troll corpses" code is going to need generalization to "set stuff on fire"
-add reminder to use shift if player presses '.' on stairs
-blood moth brushes: check for LOS, so you don't see it when detected.
-redo endgame
-add more possibilities to sliding wall traps. probably check dlevel, too, to scale properly.
	-chests, for sure. rare, but possible. (you shouldn't be able to pick up and reset sliding wall traps, though)
-lit rooms, finally?
-berserker's axe should be able to crit, right?
-if a monster inflicts Weak Point on crit, and the player's armor already has it, that monster should never crit, right? unless Worn Out checks for any crit.
-get rid of quickstart.txt
-animation for lasher tentacle(if it doesn't have one). better animation for spores.
-maybe enemy critical sneak attacks could automatically make your armor Damaged too, instead of stunning.
-consider changing messages like "you are chilled", as this implies a status or something.
-i'm not sure that poison gas dealing 0-2 damage is so great after all. maybe 1-2 or 1-3 damage instead?
-viewing inventory after death should ID items for you!
-add a lot more combat info to monster description boxes: speed, damage, "Melee effect:" or "On hit:", "Critical effect:", "Abilities:".
	-try to describe every monster in terms of "Abilities:". If it's not short enough to be readable, the monster might be too complex.
-remember to make all the *complicated* monsters uncommon.
-now that there's so much room, add target health to sidebar. (but "corpsetower behemoth" doesn't fit! maybe use its symbol?)
-some on-hit effects, like golem, should probably happen even on misses
-monsterdex, with a file to track which you've seen? maybe later.
-elemental damage removed from frostling, pyren, and drake. check balance.


sunlight and darkness also become scrolls. (at some point they might become charms that have only a 1/3 chance of vanishing on use)
(scrolls burn, potions might or might not break when thrown, orbs are thrown only)
do any items NOT automatically get ided on use? passage might be weird. detect monsters on an empty level, maybe. sunlight or darkness if already lit or dark. hmm.

stop scroll of passage being 'nice' when used
	-this is also part of the "when to ID and when to fail" problem.
	-make scroll of passage choose a random wall?

consumable ideas:
orbs: 
grave dirt, fungus and/or plants, 
transposition: radius 3 or 4, randomizes positions of actors hit. 
'shattering' except not: turns walls into floors, temporarily. when they change back, they push actors back, but no damage. 
shield 'grenades' from resistance: creates zone wherein a weak shield is refreshed each turn. -might be a pain, so it might just shield once instead.
teleportal/portals/vortexes/rifts/spatial rift/etc: creates portal feature. lasts several turns. at first I wanted these to teleport randomly, but teleporting
	everything to the same spot would work too. 
shards, negative energy, electric, whatever: radius 4. 2d6 damage, and an additional 2d6 damage if attacked/dealt damage in the next X turns.
...polymorph?
one that makes dancing lights that follow the nearest thing. probably too much of a pain.
collapse. maybe bigger.

list:	fire, ice, fog, detonation, 'shattering', shielding, 'rift', 'shards', 
	(slime? poison gas? sleep? another positive effect?)


potions:
potion of ethereal something, or ghost form, or spirit form, etc. You can't attack but you can walk through walls. Monsters can still see you and follow you but
	they can't hit you in melee until the effect ends. You might give off light. (honestly i'd rather have this NOT prevent monsters from attacking you)
		-what if attacking or being attacked ended the effect?
			-you can't attack, but you can be attacked

potion of shrinking. +stealth, -combat, -defense. might slow you? i don't know if this will work, but it'd be nice.

potion of (scent, needs name). Grants bloodscent but imposes a maximum on sight distance. (hell no. not worth the implementation right now.)
potion of haste/speed, of course. Movement only, or not? Might reduce effective exhaustion while it lasts?
	-movement only. effective exhaustion of 0 while it lasts. might be called "energy" or "sprinting" (?)
still considering the potion of the third eye (name?) to replace ?oDM.
potion of growth/roots. prevents movement, including teleports and knockback. either increases defense a bunch, or frequently spawns plants nearby.
classics: sleep(would be more interesting if it gave a benefit too), ...

list:	healing, regen, 'stone form', cloaking, vampirism, brutish strength, 'roots', 
	(speed? third eye? spell disruption? (i think so!) spirit form? too many drawbacks?)


scrolls:
scroll of repair for sure.
i could actually have protect armor/weapon/equipment too. it'd be temporary. several hundred turns, perhaps?
scroll of trap disarming. drops them as items, of course. If you don't have the feat, you might fail at setting them.
	-actually, scroll of trap clearing, which sets them off, will probably replace this one.
		-when implementing trap clearing, set off the traps in a certain order based on type, so phantoms come last.
scroll of calling. brings the closest monster to your side.
classics: summoning, aggravate(meh), traps, curse weapon/armor(hmmm), detect objects(nah), 

list:	blinking, teleportation(?), passage, time, detect monsters(?), magic map, sunlight, darkness, repair, calling, trap clearing, 
	(protect weapon/armor/equipment?)


update weapons, do new crit effects for weapons and monsters.
okay, now should I implement these, or should I wait until I have a full monster list? i think the latter.


-increase base crit chance to 10%
-dagger still gives at least +10%
-sword cuts off 40% of health on a crit
-mace ignores armor (i.e. doesn't get blocked by armor). does something on crit. (double damage? stun? reduce accuracy or damage of target?)
-dagger probably still stuns on crit

iteration 1:
Sword: (No ability)   Critical: Deals a minimum of 40% max health.
Mace: Not blocked by armor. Critical: ??? (double damage? reduce accuracy or damage of target? target takes more damage? extra damage that doubles on each crit?)
Dagger: Twice as likely to crit. (includes bonuses such as Lethality) Critical: Stuns target for (X) turns.
Staff: +2 Defense bonus. When this causes a miss, attacking that enemy switches places, then knocks it backwards. Critical: +2 effective Defense vs. that enemy(?)
Bow: Ranged weapon. Critical: Deals extra damage based on proximity to target. (?)
Enchantments: Echoes is good. Ice might be "Deals 1 extra damage. Doubles on each hit." Holiness is fine because it's limited. Force and fire are harder. (need new ones!)

-also, critical sneak attacks with arrows should also kill - but misses should alert enemies!

goblin bat wolf skel moth swordsman dweller bramble frostling dwarrior
cultist archer shaman mimic killer zombie direrat zealot shadow banshee
warg spider ascetic poltergeist hag compy worm berserker troll vampire
cknight sabertooth mudelemental entrancer marblehorror ogre grenadier
duelist crawler pixie golem pyren assassin seer mknight warmage lasher
necro avenger behemoth drake phantom

which enemies are too complicated? which ones am I unable to describe quickly?
goblin: basic melee
bat: flies erratically
wolf: fast
skeleton: ???
moth: flies, attracted to light
swordsman: switches to a more aggressive stance if you don't attack him in melee
dweller: sensitive to light
bramble: immobile
frostling: ranged attack, burst attack
dream warrior: illusion (desc?)
cultist: sets itself and nearby things aflame
archer: shoots arrows, stays at range
shaman: casts force palm and immolate, sometimes stays at range
mimic: disguises self as an item
killer: stealthy, throws bola to slow
zombie: slow, lunges
dire rat: large groups
zealot: carries light, casts holy shield (name?) and heals self
shadow: dims light sources, invisible in darkness
banshee: fast, screams to cause fear
warg: (medium?) group, fast. howls to buff packmates
phase spider: teleports and poisons
ascetic: spell disruption
poltergeist: haunts an area and steals items
hag: curses attackers
compy: large group, nonaggressive, special poison
worm: poison cloud, breathes poison, (slow?)
berserker: raging axe attack, resists death
troll: regenerates, even beyond death
vampire: flies quickly, sensitive to light, drains life, can summon blood moths
c.knight: carries light, reveals stealthy attackers
sabertooth: ???
mud elemental: resists weapons, animates walls
entrancer: commands a minion, teleports and shields that minion
marble horror: disguises self as a statue while in darkness
ogre: small group
grenadier: tosses grenades, sometimes stays at range
duelist: invisible in darkness, sidesteps after he attacks
crawler: paralyzes
pixie: flies erratically, disrupts spellcasting nearby
golem: slow, resists elemental damage, creates stalagmites when it attacks
pyren: shoots flaming arrows, stays at range (sometimes?)
assassin: stealthy
seer: regenerates, even beyond death, casts glacial blast and sonic boom, teleports attackers away at low health
mknight: immune to damage, except when it misses or against critical hits.
warmage: casts (several spells)
lasher: attacks and pulls targets at range, spore burst upon taking damage, immobile
necro: summons undead, shoots dark energy
avenger: fast, gives off light, holy shield(name?), can darken level to fully heal
behemoth: slow, (leaves grave dirt as it walks - new), stuns on hit, regenerates
drake: fast, breathes fire, seeks player, 
phantom: dies to any damage, flies, various other effects depending on type.

possible effects: double/max damage, stun, knockback, paralysis, %damage, reduce accuracy, reduce damage, increases damage taken, inflict Weak Point,
inflict Worn Out, refresh cooldowns, make noise, dim vision, poison, blind, summon phantoms (or clones...), teleport, freeze, hallucination, rubble (from floor or wall), fog, grow plants, defensive shell mode, aggro stance, berserk, grab, immobilize, link (allows attacking target at range), re-stealth, life drain, fear, spell disruption, steal, buff minions, burning, slow, sleep, possess weapon, swap positions, infested/red-hot/rusted armor, 

common effects: max damage, stun, knockback, increase damage taken, weak point, worn out

now! which effects should replace the default? "the goblin hits you. you are stunned!" doesn't replace...  "the swordsman hits you, exposing a weak point on your plate mail." or just "the swordsman hits you. a weak point is exposed on your plate mail!" - that's better. doesn't replace.  "the blood moth bites you. the blood moth drains life from you!" "the cavern hag clutches at you. the cavern hag grabs you!" ... "the dire rat bites you. the wound leaves you vulnerable!" or smth.
"you are knocked back!" or "the foo knocks you back", either way.

what do I do for max damage, if I don't want to keep "critically hits you"?  "the goblin hits you. it was a good hit!"
	-or "Ow!" as a short option

(maybe a general guideline of "crits get exclamation marks" ?)

goblin(s): stun
bat: reduce accuracy for X turns?
wolf: either max damage or worn out
skeleton: 
moth: life drain?
swordsman: weak point
dweller: grab or (common effect)
bramble: max damage
frostling: freeze
dream warrior: summon clone or (common effect)
cultist: 
mimic: none
sk. killer: weak point probably
zombie: max damage or %damage or grab
dire rat: increase damage taken
zealot: knockback
shadow: dim vision or reduce damage taken from player/reduce damage dealt by player
banshee: max damage or worn out
warg: max damage or increase damage taken or stun or swap positions
spider: none
ascetic: grab or (more likely) swap positions
poltergeist: (can the poltergeist even crit? if so, it should make noise or blind or slime)
hag: grab would work here. otherwise, max damage.
compy: make noise or stun or max damage
noxious worm: stun(likely) or max damage or knockback
berserker: max damage or %damage and/or worn out
troll: worn out
vampire: none
crusading knight: worn out or paralysis or knockback
sabertooth: max damage or slow or ???
mud elemental: reduce accuracy or blind or slow
entrancer: stun
marble horror: stun or worn out or ??? - none, if it keeps dim vision.
ogre: stun or worn out or ???
grenadier: knockback or stun or increase damage taken
duelist: weak point probably
crawler: none
pixie: stun or reduce accuracy/damage or weak point
golem: stun or knockback
pyren: fire trail or weak point or aggro stance or burning or red-hot armor
assassin: restealth
seer: ???
mechanical (or clockwork) knight: ???
warmage: ???
lasher: grab (only at range 1) or ???
necromancer: buff minions or life drain or ???
avenger: reduce accuracy or blind or max damage or stun
behemoth: none
drake: ???
phantoms: (all of them might get either stun or max damage, but reduce accuracy miiiiight work)


magic items:
first, a list of possible effects. Most of them will have requirements and/or triggers, so these can be of varying power levels:
arrow deflection, AOEs that trigger on damage, spirit form, escape, life saving, fortification, glow when goblins/orcs are near, increase trap detection, detect monsters within X pathing distance, if you're on fire and you attack it puts out the fire and deals more damage, random visions of nearby areas, sense (item type), (+one skill, -another skill), increase carrying capacity (not likely), orbs show surrounding area when thrown (?), bonus to arrows (but not a broken one), blindsight (useful!), darkvision, 

and possible restrictions/activation methods:
druidic (no metal equipment), standing still, 

and possible complete items:
x of focus (stand still to increase your melee accuracy on the next turn), x of counterspells (if you know a spell cast on you, you try to cast it to cancel?), x of evasion (chance to dodge spells and arrows if you moved last turn), fire cloak (prevents freezing), 


possessed status for weapons
 can force attacks. when and how? could be "when you hit an enemy with
 this weapon, you'll spend your next turn attacking again if possible"
OR
 "each turn you could attack an enemy while wielding this weapon, you
 have a chance to automatically do so"
	-needs work
OR
 take the mechanic from crawl: you can't move away until that enemy is dead.

echo enchantment (weapons)
 when you hit with this weapon, the attack echoes and happens again,
 one tile in the same direction. (i.e. it goes in a line until a miss)
	-great!

increased crit chance enchantment

quick observations about things that work really well in brogue that I don't have:
-terrain you can see (and ranged atk) through, but not walk on (chasm)
-terrain that changes as you walk through it (dense foliage)


CHANGES:

MECHANICS:
global magic penalty (25% for those 2 Magic feats, 5% for advanced spells, added to all fail rates) is changed to exhaustion(probably still 25% for those 2 feats and 5% for advanced spells. Added to all fail rates, and also gives ...
so, exhaustion is always added to your fail rates directly (until there's a feat/magic item that changes that).
if exhaustion is at 100%, you miss half of your attacks outright.
at 75%, you can't effectively wear leather (you get no AC from it).
at 50%, you can't effectively wear chainmail.
at 25%, you can't effectively wear plate.
	-might still need a message for when you CAN wear your armor effectively again. but maybe not.

natural recovery nerfed (10->5) or removed entirely. 

possible combination of bosses and special levels. example: grab poison to buff yourself for fighting the boss, or just fight it. X levers that must be flipped, or items collected. Heavy use of minions and other 'smaller versions'.
	-"boss levels" will now be the penultimate level. the final one will be more puzzlelike, perhaps.

UI:
remove AC from main screen. main display now has HP, Depth, Weapon, Armor, Magic item. There are 3 empty spaces between this and the command list.
on equipment screen, armor should say "+2 to Defense skill" or "2 bonus Defense" instead of mentioning AC or vaguely mentioning "really good protection". weapons should no longer mention "2d6" as this is the default now.

FEATS:
all feats will now be comparable in power. feats are gained at skill level 1 and 6. you no longer need to master feats - as soon as you select one, you can use it. -this part is done.
specific feat changes:
 silent chainmail: replace.
 distract: replace. (thrown items will replace it)
 master's edge: nerf. (+1 damage for every 1d6 base damage?)
 boiling blood: add another bonus when you're at 5 stacks.
 disarm trap: can now pick up traps, drop them, and reset them.
 enduring soul: changes from 20 to 10. see recovery change above.
 danger sense: only works on visible enemies. -CORRECTION: only works on enemies that you've seen, at any time.

TERRAIN:
firepit: being knocked into one will set you on fire.
traps: can now be triggered by arrows or thrown items (including orbs).
healing pool: can throw an item in, too, so don't throw things at them.
quickfire: could remain the same. still doesn't ignite things, right?
            what if it spread until it consumed an item, then died out?
		i think it needs a reimagining.
quickfire becomes oil or napalm or something. traps and orbs throw a flammable substance around themselves, and then start
	a fire in the middle. (does it coat actors? how similar is this to slime?
blast fungus: explodes a few turns after being exposed to light. deals
               major damage. these should knock down adjacent walls,
               too, and probably instantly kill most enemies behind
               those walls. (~40 damage?)
stone slab: should now appear occasionally(!) instead of a normal door.
             opens when light hits it. (target tile is set to self)
some types of terrain are 1) cool and 2) can be used to trigger monster abilities, even if they don't do anything on their own. so add some!

ARMOR: probably change the way that armor affects stealth & magic. add several things that can affect your armor (some could even be good), like Infested, Rusted, Red-hot, Slimed, Blurred, Glowing, 
       then, think about things like electric vulnerability, not fitting through some spaces, catching on things, magnets - or, even better, jday's ideas of 'bonus if you didn't move', 'bonus increases as you move away from the one you attacked', 'bonus against range' (this one is probably an effect instead), 'damage is capped', etc.
       plus a few more: plate is shiny, so just standing in the light is just as bad as holding a light source yourself.
(now, instead of AC and stealth+casting penalty, armor will have only AC and stealth penalty. perhaps chain and plate will get the same penalty, even(cut stealth by half?), and then plate will get Shiny on top of that. remember to add a tip for Shiny.)
Weak spot (enemies get +10% crit chance while you're wearing this armor). might be inflicted by swordsmen etc.
Spored - inflicted by the bloat enemies when they explode on you. after X turns, if you have any spored armor, more bloats will spawn. also has a secondary effect. (maybe a message to warn of imminent spawning?) Does fire remove spores too?

WEAPONS: why use a mace against golems? your sword can be blunted!
slime on a weapon supresses its fire enchantment.
sticky: can get stuck to monsters when you hit them. you can't make attacks until you step away from that monster to unstick the weapon.
heavy: chance of exhaustion after swings.
negated: enchantments don't work.

MONSTERS:
some monsters should become territorial and not rush over to you when they see a torch flicker.
many toxin-immune monsters should be immune only to their own toxins.
skeleton: oh gosh what do I do. maybe they should blunt edged weapons, but maybe not. maybe they should be immune to all 3 elements (?!?). maybe they should introduce the concept of hardness/damage reduction instead of resistance. or i could just remove them (and sabertooths)!
wargs will get a howl. what will it do? perhaps they'll split up. more likely it'll be used when some of them can't reach you, and increase crit% for a turn.
hags will be tweaked a bit, probably getting some new curses.
compys might need an AI tweak. (weak, occupied, helpless? remove one?)
vampires still need help.
shadow(veil) could gain a message when it steps from visible light to visible darkness: "fades from view as it steps into the shadows"
darkness dwellers: should they check at the start AND end of their turn?
  otherwise they can still hit you before being blinded.

ITEMS:
healing will fully heal you and remove all exhaustion (but not poison, burning, etc). as a result, clarity is removed.
regeneration will last for 100 turns
toxin immunity -> stone form(needs better name): you become immune to toxins, can't drink potions, can't catch fire, stop regenerating, etc. 
 -actually, "stop regenerating" might be extended to "stop all ongoing potion effects", including brutish strength and vampirism.probably gain some armor but lose stealth. not sure on that last part.
A possible change to blinking (or more likely teleport). not sure what.
there's the potential to switch ?oDM with a third eye potion that also blinds you.
sunlight and darkness don't last forever, as above.
rename/repurpose the prismatic orb? it's cool as a weapon, but "prismatic == fire/cold/lightning" doesn't really work for me.
freezing orb's radius should probably be 2, not 3.
You'll probably start with 5 bandages, and the game won't generate any more.
what if quickfire was reimagined so that it always came from an item? you could get it under control and pick it up again. meh.
orb of fog...could become a trap instead. - nah, it can stay, but make it last longer.



ADDITIONS:

slime: moving/attacking while on slime has a 1/3 chance to fail. on a
        failed attack, you fall and get slimed: 50% chance to fail
        to use an item, and drop it instead. other stuff too.
cracked walls: destroyed by brutish strength, grenades, or blast fungus
                (and not just adjacent). can appear between rooms.
		i'm pretty sure knockback should break these too. throw
		your enemies through them to open them up.
brush: flammable. blocks LOS to anything not in the same patch of brush
bell-like object: bashing-type attacks will stun and/or damage guys on
                   the other side, while making noise. conducts elec.
ropes connected to ???
slime pods that spread slime around
spinning pillar axe traps. thanks, redmike.
those back&forth guys from zelda, but elec dmg changes their direction.
deity statues: one for each skill. They affect everything in their FOV, or everything in a certain radius, or just the closest one in their FOV/radius, by setting one of its skills to 10 temporarily.
'beach ball bloats': take bloats from brogue and make them a bit tougher by having bashing attacks send them flying instead of popping.
add broguelike "you are in tall grass" descriptions. it'll help.
there are some plant terrain ideas below.
monster that pushes everything away when it takes damage. (deals damage too?) probably an artificial being or an assassin.
items: the most obvious are the tradeoffs: losing your stealth, or combat, or magic, or items, or movement, but gaining something else.
Ingrain effect that trades movement for regen? prevents teleporting and knockback too? sounds good as a counter for teleportitis.
 -so, maybe it doesn't do regen, since that's already an item.
An enemy that makes you exhausted if you hit while its shield is up
probably not: fountain of life. heals hp each turn, but might animate an item which then runs from you.
A lot of different crit effects, not just double damage: armor penalties, stuns, poison, slows, blindness, knockback, prevent attacking (or just attacking that target!), ...
enemy that ONLY wakes when you get near, or when you fight near it, ...
possibly a bonus effect for armor mastery.
-a monster that charges up and fires. maybe just once. -maybe the lightning rift idea? charges up, throws a lightning rift that increases its radius each turn. if something is in the radius, it zaps it. the enemy could also have the "when damaged, release electricity" thing. Would make a good boss.
brutish strength might knock enemies back in addition to dealing heavy damage.
blind monster that uses aoe attacks when it hears sounds.
gravel that crunches when you walk on it.
advanced combo traps on later levels? darkness + summon shadows/shadow duelists/other. (meh. maybe not.)
monster with a gravity field that stops arrows and thrown items, and makes your weapons act like they're Heavy.
sleep effects that aren't magical drowsiness
a poisonous monster that can poison your weapon when you attack it
a trap that spawns multiple bloat-type enemies nearby?
spitting cobra - nonaggressive but territorial. blinds at a short distance.
teleportation rifts as a rare feature. Maybe these differ from the orb version and always teleport randomly? ("unstable" vs. normal?)
"can't attack in radius X" effect - possibly terrain-based but rare to activate? like an altar activated by zealots?
	-the monster-activated idea is cool, but here's another version: an altar of peace or pacifism. if you fight next to it, it activates and prevents combat.
trap of move traps? would hide & relocate nearby traps.
jungle terrain type - blocks LOS, doesn't burn. kinda the same as permanent fog, without the miss chance?
	-meh?
a quiet terrain type that reduces noise values by 2(?)
areas of (light gray?) stone with rubble scattered about. (what about rocks?)
basic magical(?) effects for terrain: increased damage (both ways, probably!) and/or increased accuracy, 
cloud elemental that spews fog? electric attack?



[14:26] <jday> dsc: Instead of thinking about the pieces, have a list of combos on a piece of paper.
[14:26] <jday> Your game doesn't have goblins, jackals, archers -- it has   goblin+jackal+archer   which seems to come about by chance when it happens.  Then you make some notes on how to make sure it happens often, and how not to break what it does.
[14:29] <ds-creamer> I started today by looking in the wrong place, apparently. I was thinking of monsters and the methods of interacting with them, and somehow I got it into my head that brogue's monsters were a lot more interactive than mine.
[14:30] <ds-creamer> A comparison showed that I was wrong about that, and it must be the traps, thrown items, gases, etc. that are creating a lot of this gameplay.
[14:30] <jday> Also AI quirks.
[14:30] <jday> Monsters should be stupidly smart, with a dash of believable stupidity.

[14:36] <jday> dsc: I bet you could find a few small changes that would do a lot of what you need.  A few bits of Delusions, for instance.
[14:36] <jday> Like the old "stones" idea -- have an item which, when thrown, does what Chicken does.
[14:37] <ds-creamer> jday: Do you mean AI quirks like 'flees at low health' and 'stays in terrain of choice' and 'keeps distance', or like 'grenadiers will toss grenades even when adjacent to an invulnerable player'?
[14:37] <jday> Both.  The latter is totally ok when flavor justifies it, and can even be quite good.
[14:38] <jday> Players pick up on this stuff intuitively most of the time and it can be a big deal.  Like, even something like whether a monster prefers to stay next to the wall or will cut through the middle of the room when chasing you could matter and be noticeable.
[14:38] <ds-creamer> This method of comparison doesn't seem to be very productive - I'm not spotting the differences and I feel like I'm missing the big picture.

 <jday> It's entirely about space.
[14:38] <ds-creamer> ('but my monsters do most of that stuff already!')
[14:39] <jday> Draw a couple of rooms on a grid.
[14:39] <jday> And start blacking out squares where it would be a terrible idea for the player to go.
[14:39] <jday> And then start marking squares where the player can sensibly go with a certain resource use.
[14:39] <graspee> start blacking up monsters. then put on a minstrel show!
[14:40] <ds-creamer> Most of the ones I have come down to 'fight in a corridor' or 'don't fight in a corridor or tight space'
[14:41] <jday> And that is the whole game, that space allocation.
[14:41] <ds-creamer> (terrain types need some serious expansion, for sure)

 <magikmw> Don't fight further away than two tiles.
[14:41] <jday> Traps, for instance, can make it so you don't want to fight near one because a monster might trip it.
[14:42] <magikmw> Or you actually might want the reverse.
[14:42] <jday> Yes!
[14:42] <jday> Either way, it changes the situations in which you want to be in the space.
[14:42] <ds-creamer> I had the wrong idea at first. thought you were still talking about monsters.
[14:42] <jday> If you have a goblin, you can lead him through a room to another room where you'd rather fight him.  But if you have a jackal behind a goblin in a hallway, you can't lead them across a room -- the jackal will get loads of free hits.
[14:42] <ds-creamer> But brogue's monsters don't really do that either
[14:43] <jday> They do a little bit.  But not much, you're right.  I bet we can find better options.
[14:43] <ds-creamer> I suppose that should be "more than the ones in Forays"
[14:44] <ds-creamer> (some of which are deeper, and I should be mindful of that fact)
[14:44] <jday> So you take that grid you've blacked up, stop it singing "Jimmy Cracked Corn," hand it a pamphlet on workplace discrimination, and ask yourself how you can make the black cells a good place to enter, or the white ones be bad, based on other considerations.

 <jday> You want different rooms to be places you want to be or don't want to be, depending on what you're fighting.  That's the easiest thing.
[14:45] <jday> Think of all the times you lead a will-o'-the-wisp down a certain corridor to keep it away from a scroll or something.
[14:46] <jday> Even something as simple as mixing well-lit and poorly-lit rooms.  Flammability and shallow water.  Floors that will burn out from under you and make you fall before you're ready.
[14:46] <ds-creamer> So the proper approach really does seem to be "everything at once"
[14:46] <jday> It is, but you can simplify it.  The simplification is, "How do I make it so there are different situations when I loathe meeting different enemies?"

 <jday> One answer is, "When I'm already fighting some _other_ enemy."  Hell, even having two enemies that sort of cancel each other out would be great.
[14:47] <jday> (Brogue has a few kind of like that: wisp + zombie, foo bloat + anything.)
[14:47] <jday> So you'll have a case where you know there's something sleeping somewhere, and you want to lead another monster to it.  That makes for shenanigans.
[14:49] <ds-creamer> I also realized I had a few abilities that sounded good, but were actually just equivalent to more damage in most cases. I can improve that, too.
[14:52] <jday> Define them in spatial terms.  FOV, proximity, adjacency, and diffusion are a few great ones.
[14:52] <jday> Something like "this monster does x when its victim is in FOV but distant and is not in FOV of a crystal."
[14:53] <jday> Draw out the places on the map where you don't want to be for a rule like that.  It gets pretty crazy.
[14:53] <jday> (or s/crystal/light source/ for more generic applicability.)
[14:53] <ds-creamer> Shiny...thing

[14:53] <jday> Are there floors in Forays where you can't put out fire?
[14:54] <ds-creamer> not yet!
[14:54] <jday> And are there floors where you can't be lit at all?
[14:54] <jday> Add those two and they'll add creases to every rule involving burning.
[14:55] <jday> For free, suddenly, all the immolation in the game is a way to make the player decide where to fight -- and risk an ambush on the way.
[14:55] <ds-creamer> Also not yet, but that one was actually (somewhat) in the works, in the slime > fire > ice > slime trio
[14:59] <jday> dsc: Also, timed effects and random effects in terrain.  Here's one Brogue doesn't have: A door that opens and closes every three turns.
[14:59] <jday> It's easy to make pathfinding take it into account (it has a movement cost of 1 + the number of turns until it opens).

 <jday> (ok, ideally you want that cost to reflect when the monster expects to get there, too, which isn't too hard, but the player won't care if they do it wrong.)
[15:02] <graspee> monsters should not necessarily be able to perfectly judge door timing
[15:02] <ds-creamer> *squish*
[15:03] <graspee> really stupid monsters could be changing path every so often like someone changing lanes at a supermarket checkout

---------
---------

[10:25] * ds-creamer leans toward removing armor altogether from forays
[11:23] <Pupnik-> what problems is armor causing in the gameplay?
[11:29] <ds-creamer> Pupnik-: it's not tactically interesting right now. it's more like a slight permanent boost to the player.
[11:30] <ds-creamer> (You pick the one that suits your build and playstyle, and you keep it on.)
[11:31] <ds-creamer> stealth or magic? you might want leather. fighting? use plate. But it's not interesting, and it seems like a good candidate for streamlining.
[14:25] <jday> dsc: Here's an idea for armor/weapon in forays -- what if they could be damaged in various ways, but that damage is temporary (one level only, or fixed when you rest (which is one level only))?
[14:25] <jday> Then there might be decisions about using your sword up now, when you might want it later this level.
[14:27] <jday> The same could apply to armor, and might even be able to tie into terrain.  e.g., leather might give you a boost on rough terrain; plate might only protect you if you stood still last turn.
[14:28] <ds-creamer> jday: interesting...'blunted', 'out of ammo'...i'm not sure where else to go but magical effects.
[14:29] <ds-creamer> 'red hot', 'backbiter', 'covered in spiders'...
[14:29] <jday> Your armor could get insects in it, yeah.
[14:29] <jday> "Plate Armor: Infested (-1 hp per turn)."
[14:30] <jday> And when you rest, you add a message about "cleaning your equipment" or something.
[14:30] <jday> Clearing a level takes on a puzzle element of ordering your resource use according to the fights you expect.
[14:32] <ds-creamer> i'm not sure about that part, since without Stealth you don't have as much ability to dodge fights as you do in Brogue.
[14:34] <jday> Leather could be immune to damage like in Rogue, or nudism could be an option.
[14:35] <jday> But the point is, if stealth is critical to you, don't waste it on the parts of the level you don't need to sneak through.
[14:36] <jday> The one last thing you would want is a way to make changing armor costly.  Brogue is switching to have a "warm up" period when you switch armor -- like you start with a huge strength deficit.
[14:36] <ds-creamer> Are you talking limited resources or stealth skill, there?
[14:37] <jday> You mean, making armor changes costly?  The goal is to make it a serious decision when you switch armor face to face with an enemy.
[14:38] <jday> So you don't just say, "oh he's played rock I'll play paper," all the time.
[14:38] <ds-creamer> I meant "don't waste it", sorry
[14:39] <jday> You get a few types of costs that interact.  The resource cost ("I might use up my paper") is a gamble, and it plays into space via exploration (gambling against unknown).  If you have a cost to switching armor, it ups the ante.
[14:39] <jday> Because you say, "Well, I think I can take him in this suit of armor," when really it might be optimal to switch.  "Scissors vs scissors?  I'll take my chances."
[14:39] <jday> A time cost, after all, is really a distance cost -- everything gets closer to you before you're really safe.
[14:40] <ds-creamer> That stuff is great, yeah. The part I didn't like the sound of was "the fights you expect", implying spoiler knowledge

[14:41] <jday> Ah, yeah.  I mean more like, "I'm going to have to sneak past a scarecrow, but I don't want to do it in this armor."
[14:41] <ds-creamer> (and I misread "ordering resource use" as "ordering fights" and thought you wanted a lot more scouting action)
[14:41] <jday> And, of course, if suits of armor interact with space differently, you get a third way to make armor interesting.  stealth vs melee isn't (very) interesting -- it doesn't exist on the game board.
[14:43] <jday> A few armor types might include: [ ] one that only works if you didn't move last turn   [ ] one that defends you least against the enemy you attacked, but more as you get further from that enemy (most at your back)  [ ] one that imposes a maximum on the damage you take per turn
[14:43] <ds-creamer> "Plate Armor: Infested (-1 hp per turn)."    That one line is probably reason enough to keep armor.
[14:43] <ds-creamer> (I still want to rework how armor affects stealth and casting, though. Numerical penalties, ew.)
[14:44] <jday> It could be that it picks up stealth penalties over the course of a level; that's one thing.  It could also have a fixed % chance of announcing you each turn, so you get a separate message from it.
[14:45] <jday> "Your plate clatters."
[14:45] <jday> And if it rusts, then it starts squeaking.
[14:45] <jday> Could also be light effects -- if plate is shiny, then maybe you stand out whenever a light source is in fov.
[14:46] <ds-creamer> Getting caught on things, too. I'm not sure which armors would be most vulnerable to that. Rust is a good one, although I'd have to not let it apply to leather.
[14:47] <jday> That's fine!  You can reflavor some effects, and you can just let different effects target different suits.  Come up with flavors that make sense, and then worry about making terrain/monster interactions with them multifaceted.
[14:48] <jday> Let's see.  Magic and casting -- why don't casters wear armor, except for the fact that you don't want a caster to engage in melee?  It's basically flavor from the church, isn't it -- no shedding blood?
[data expunged]
[14:49] <ds-creamer> Casting sometimes requires complex movements that mages can't do in armor, or something.
[14:49] <graspee> but the no metal armour is variously rationalized by: hinders complex movements for spells, metal interferes with the magic field...
[14:49] <jday> [ ] Think of spells that don't synergize (hooray managerspeak) with melee and use lots of them.  "Stay away!" kinds of spells.
[14:50] <ds-creamer> Druids do the no-metal thing. Which reminds me: I'm going to vastly expand the magical items you can find, and a druidic one that only works in leather is a good idea.
[14:50] <jday> Yeah, the no metal is easy to make sense; the question is (for me) why we want it in games -- and it's basically to make different kids at your table have different parts to play in the story.  Less important for a lone rogue.
[14:52] <jday> dsc: So ultimately we want to know why the swordman in plate has an incentive not to cast fireball at every monster that approaches, totally mechanically.  This is the whole matter, boiled down.
[14:53] <jday> [ ] spell casting can drain you, causing physical weakness   [ ] attack spells can be more situational   [ ] as before, spells that keep monsters from approaching are useless to melee (except for tactics)

[14:54] <jday> Armor doesn't have to be the way that the two interact, in other words.
[14:57] <ds-creamer> oh, hey
[14:57] <ds-creamer> Right now I have a "global magic penalty" that increases the fail rate of all spells. 2 of the Magic feats use it as a resource, and casting spells above your level drains it too.
[14:58] <ds-creamer> I should turn it into a generic 'Exhaustion' stat, and then no swordsman would want to cast especially advanced magics.
[data expunged]
[15:00] <ds-creamer> (Bonus: Things can inflict exhaustion on you and it sounds better & matters more than "This guy increases your magical fail rates")
[data expunged]
[15:02] <ds-creamer> jday: And then, to actually answer the question, I suppose heavy armor would get a bigger penalty for exhaustion.
[15:04] <jday> dsc: So basically melee ends up needing, but not actually costing, magic.
[15:05] <ds-creamer> Needing in a strategically optimal way for some builds?
[15:06] <ds-creamer> or do you mean the new use of the Exhaustion resource?
[15:24] <jday> dsc: Exhaustion, yeah.  It's like credit that pays itself off with time.  You think of exhaustion building up, but it's kind of "freshness" that runs down from 0.
[15:25] <ds-creamer> jday: Oh, then yeah, that was it.
[15:27] <jday> dsc: The notion is, magic is like something you charge, but melee is something you need to pass a credit check for.
[15:29] <ds-creamer> I think so. Maybe I'll end up with a Combat feat that exhausts you, too, though.
[15:32] <ds-creamer> jday: It could really become a general resource - an alternative to HP damage that happens sometimes. (not all the time like a stamina system, though)
[15:33] <jday> I love what happens when you figure out what problem a broken mechanic was meant to solve.
[15:33] <ds-creamer> An enemy that makes you exhausted if you hit while its shield is up. I can roll !oClarity into !oHealing, too.
[15:34] <ds-creamer> I'm seriously thinking about an ID game, too.
[15:35] <ds-creamer> (perhaps one with no scrolls of ID and no pure negatives)
[15:40] <jday> That could work well since using the wrong good scroll is a steep cost.
[15:40] <jday> Consider the possibility of having _one_ pure negative, but it always looks different, so you never ID it.  You might decide never to identify the last class or two because they're not worth it.
[15:41] <ds-creamer> That's an option, depending on how many I end up with.
[15:41] <jday> There's also one that was in Toejam and Earl -- one that re-randomizes the names of the other items.  Works less well when you have items in your inventory though.
[15:44] <jday> (Although you can solve the issues with that by just not renaming the ones you have right now -- all future scrolls are generated with the new names.)
[15:44] <ds-creamer> I might arbitrarily have orbs be autoIDed for flavor reasons.
[15:44] <jday> I bring these options up because a simple id game can bear one complicated feature easily.
[15:45] <ds-creamer> That one might make you think twice before using the last of a stack
[15:47] <jday> You could very well decide to leave three kinds un-id'd if you've got your favorites.


-------------------------------------------------
-------------------------------------------------
-------------------------------------------------

[17:37] <jday> dsc: What if you pick one color for out-of-fov, one for dark, and then use the rest for walls and floors in lit fov?
[17:38] <jday> Since, say, blue for shadows would look like you just can't see the color.
[17:39] <ds-creamer> It works at first, at least. But you can't mix colors when you have even amounts.
[17:39] <jday> Even amounts?
[17:40] <ds-creamer> (are we talking about using other colors of light, or about hallucination visuals?)
[17:41] <jday> Neither, and maybe you've already made a change like this that I don't know about.  In ordinary play, yellow has always been bright.
[17:41] <jday> But what if instead, all colors but blue are bright, and you can't distinguish when they're unlit.
[17:44] <jday> dsc: I mean, I can't blame you if you don't want to go all Cogs-of-Cronus in your color scheme, but you'd get more mileage if you had another twelve colors free.
[17:46] <ds-creamer> jday: to clarify, do you mean using more colors for light sources (that then color walls and floors), or making everything go blue/dark cyan when unlit?
[17:47] <jday> dsc: More colors for walls and floors, all light sources white.  Although you _could_ make r/g/b lights that just mask off those components, I wouldn't in a game as symbolic as this.
[17:50] <ds-creamer> note to self: use RGB lights in a 7drl sometime
[17:53] <jday> It could be cool, since it would keep you from knowing what you're looking at.
[17:54] <jday> I'm doing the thing that's really productive, but kind of weird right now, where I'm so zoned in that I'm not quite sure why I'm doing what I'm doing.  Apparently I've decided to add mouse support.
[17:55] <jday> dsc: feats should start being usable immediately, if that hasn't changed.
[18:01] <ds-creamer> jday: what, give one feat every 6 dungeon levels (every 3 shrines), and balance them to be somewhat even in strength?
[18:03] <jday> You want the player to get to start feeling what it's like to have feats sooner.
[18:03] <jday> So if you can have them do something at 1/4 or whatever, it would be really nice.
[18:04] <jday> (Does create problems, I guess, with more stuff to balance out.(
[18:05] <ds-creamer> jday: What about keeping the cost, but moving it to the end? Just having a cooldown period, where it takes you X skill levels to be ready for another feat?
[18:05] <ds-creamer> You get neck snap at level 1, but nothing else until 6.
[18:07] <jday> dsc: Yeah, that would be great.  Then players get to try one feat each game.
[18:07] <ds-creamer> That'd still need a little balancing, but nothing compared to different levels of each feat.
[18:07] <ds-creamer> jday: Three feats each game, even.
[18:07] <ds-creamer> It'd still be per-skill
[18:08] <ds-creamer> Assuming they can explore the entire first level, anyway.
[18:09] <jday> dsc: That also lets you ramp up the difficulty a little earlier and avoid Brogue's problem with having to equip the player in friendly territory.
[18:13] <ds-creamer> jday: About the lights, I'm still uneasy. At one point I had it kinda opposite - outside of your light radius things had their normal color, in the light they were all yellow.
[18:13] <ds-creamer> I didn't like how it obscured what shrine was what and forced you to 'l'ook.
[18:14] <jday> Right, but without the light you can justify not knowing.
[18:14] <ds-creamer> You mean "you see a shrine"?
[18:14] <jday> Would be fine.
[18:15] <jday> But you can also have it leave color on special things where the color is purely symbolic -- traps and shrines, you know?  That's ok.
[18:15] <ds-creamer> Wow, you're right.
[18:15] <ds-creamer> It adds another reason to bring out your torch, and I think that's worth a change.
[18:16] <ds-creamer> It was the inconsistency that bothered me, not the lack of knowing.
[18:17] <ds-creamer> I probably need to remove a few symbol clashes, but I want to do that anyway.
[18:19] <ds-creamer> (let's see...quickfire, statues, and runes. chasms and rubble. bandages and geysers/vents. healing pools and fire pits.)
[18:19] <jday> 5 is a good statue.  That's what I used in Brogue.
[18:20] <jday> 7 looks really cool too.
[18:20] <jday> (Not for a statue, but for lots of other stuff.)
[18:20] <jday> I mean, 7 fills space nicely; good for chasms for instance.

read above. make feats front-loaded. make blue/dcyan the only dark color, and remove [DATA EXPUNGED].


torch: as before, for now
feats: as before, for now
spells: as before, for now

weapons: most weapons deal the same base damage now.
 sword - slices off a percentage of health. On hit, or on crit? Also
         might need to fail against armor.
 mace - ignores armor/hardness? what else? or is that enough?
 dagger - probably the same increased crit chance. (?)
 staff - +X to defense/AC. attacking an enemy that missed with its last
         attack will switch places and then push that enemy 1 space, in
         addition to dealing damage.
 bow - as before. melee attacks with bow are still weak.
       but does the bow deal 2 or 3 damage now? any extra effect?
armor: not sure.
magic items: more! tons more! a million more!

upgrades: weapon upgrades (and others?) will be non-weapon-specific.
          that is, you can put 'of force' on whatever you want. maybe
          even on ANY piece of equipment.
          as a bonus, i can have more than 5 types!

items:
  potion of vampirism gives flight, life drain, and light allergy.
  potion of brutish strength could be added if I just change the boss
   fight like I want to anyway!
  healing could take you to 100% and regen could heal 100% and they'd
   still be different.

traits: 

enemies: 

goblin bat wolf skel moth swordsman dweller bramble frostling dwarrior
cultist archer shaman mimic killer zombie direrat zealot shadow banshee
warg spider ascetic poltergeist hag compy worm berserker troll vampire
cknight sabertooth mudelemental entrancer marblehorror ogre grenadier
duelist crawler pixie golem pyren assassin seer mknight warmage lasher
necro avenger behemoth drake phantom

desired changes:
swordsman: might remain the same as an intro to this mechanic, of
  course. it's decently interesting as-is: "if the swordsman is next to
  you, you might want to attack him". however, there might be more
  effective ways to create a similar result.
bramble: damage boost?
frostling: not sure. I want to change it somehow.
dream warrior: minor change: clones disappear when original is killed.
cultist: minor: message when they die to fire? animation when invoking?
shaman: the force palm+immolate combo is great. scorch can probably go
  or stay. perhaps try it without scorch?
zombie: possibly make lunges take 1 or 2 turns, to remove weird timing.
direrat: no change? not sure.
zealot: currently light+heal+halo+bless. let's simplify this. bless
  should be removed as it makes attacking too similar to the cknight.
  light+heal+halo is fine. light radius could be reduced. heal could
  have fewer uses but become stronger. not totally sure about the halo.
banshee: definitely needs some kind of tweak. make it fast like the vampire change?
warg: perhaps they could split up a bit more, and howl to summon the
  others. it might even have other effects - a warg that can see the
  player but can't reach might howl to increase the deadliness of any
  wargs that DO attack the player on the next turn.
spider: make sure poison refreshes properly. should be good otherwise.
hag: possible reduction of HP? however, it should still be hard to kill
  her in one hit without use of resources/terrain.
worm: might go to previous plan: move it deeper and have it tunnel.
vampire: not sure how to handle all the kiting. simply make it fast?
sabertooth: possible AI change from skeleton?
mud elemental: should it also grab? or is it better the other way?
marblehorror: no longer needs hacks if sunlight isn't permanent.
ogre: something besides hitting hard and taking a lot of damage?
golem: what if it created stalagmites when struck, too, and could also
  move through(and destroy) them? it'd make kiting harder.
pyren: think about that movement ability? fire trail? would be nasty
  in corridors.
assassin: better AI. another ability? or is it not needed? poison?
mknight: i think it needs to be cleaner than "on crits and when it
  misses" - or does it need to be improved in another way entirely?
	-rename to clockwork knight?
warmage: consider reducing number of spells. not sure which. improve AI
  when using passage. (is passage animation fixed yet?)
lasher: fix animation, if not already. perhaps a few tweaks to behavior
  as well. what if the radius started small and grew as you attacked?
  what if it grew only for consecutive attacks? what if it could
  eventually paralyzed instead of stunning?
behemoth: the burning fix is a little awkward. what if it turned normal
  floors into grave dirt as it walked?

likely additions?
maybe:
back & forth spike enemies from zelda
enemy that stays on top of a source of healing
monster that puts you to sleep and spawns dream eaters nearby
beamos guy
slugman
something that gives Possessed status to weapons

probably:
bloat-like enemy
assassin or artificial guy that pushes everything away when it takes damage
blind enemy that does AOE attacks if it hears stuff
poisonous monster that can poison your (bladed?) weapons when you attack it
spitting cobra
monster that lays eggs that burst with acid or slime

ideas without a monster:
crit effects: refresh cooldowns, make noise, fog, grow plants, attack link, fear, steal
staying in terrain of choice
exhaustion shield
anything that uses adjacency to walls, or other terrain types

target number? 60 or 80?


new enemies:
enemy that stays in a gap in the wall and is hard to kill without removing - maybe it has a source of healing?
more effect-on-death enemies? especially ones that leave enemies or terrain behind.
  a predator(heh) that can't see you if you're slimed
  a mostly-invulnerable monster that can be trapped or destroyed by terrain
  a monster that puts you to sleep and spawns dream eaters. you'd want to fight them with other monsters nearby!
  egg layer. eggs burst with acid or slime or whatever.
  almost-beamos enemy. rotates each turn(visible upon examination). when you(or an enemy?) step within 2-3 tiles, it activates. it hits an entire quadrant or octant at a time, and goes through all the directions. if you're still within the distance, it resets the timer each turn.
a monster, possibly inanimate or immobile, that guards important places on the map, including shrines, chests, healing pools.
totem- and turret- type monsters. (totems are probably associated with a monster type. turrets stand alone.)
 -a cultist totem would be a nice upgrade to them. 
 -one that freezes the nearest. could also be terrain.


  AND! lots of behavior-based monsters. maybe they hang out near doors,
       or guard corridors or shrines, or hide in brush, or trigger
       traps when the player gets near(hey, not bad), or like to drink
       potions or kick orbs.



terrain types: lots more!
  steal brush from LoL, then add the ability to burn it.
  ropes that can be cut (by slashing) to do ???
  plant pods or something else that can be smashed to do ???
  balloonlike objects that can be slashed or pierced to do ???
    slime pods/balloons/sacs/bubbles!
  reverberating objects. bash to stun and/or dmg guys on the other side
    and make noise, of course...and conduct electricity.
  moving traps: spinning, back&forth, etc.
  those eye symbols from zelda. shoot them with arrows.
  the torches from zelda. light them all.
  knockback into firepits? damage, or burning?
  one-way wind corridors. push items and monsters, affect fire, i dunno
  grave dirt. appears near tombstones. occasionally grabs passersby.
  tombstones: maybe you can just walk over these.



misc other: freezing should last longer and should protect you from 100% of damage (maybe). orbs of ice should be pretty good at giving you a few turns, and the difference between strong monsters and weak ones should be more noticable.
 light shouldn't always be radius 6. some enemies should give off less.
 sunlight and darkness shouldn't last forever.

ropes that can be cut or burned, but not shocked or bashed (unless maybe frozen first).

a cold effect stolen from alphaman: doubles in damage each time it's applied.




     ...................... really these would all be '&' of various
     ...................... colors, but here '!' is the trigger and
     ...................... '^' is the part that attacks.
     ........&&&...........
     ........^.&&&^........ but anyway, the plant gets generated like
     ..........*........... this. it's quite similar to corridor gen, 
     ........&&&.&!........ really. it starts from a center ('*') and
     .......!&.&&&......... spreads out a bit in any direction. 
     ............&^........ 
     ...................... each endpoint becomes a trigger or an 
     ...................... attacking part, randomly. (but there must
     ...................... be at least one of each)
     ......................
     ...................... it's functional, too, in that it can be
     ...................... burned but it doesn't hide you from view.
     ...... ............... -----------------
     ....#----#............ what can i do with ropes? this is tricky.
     ...................... here I have a tripwire. i don't think I can
     ...................... use this one yet.
     ...................... -----------------
     .........*............ here's a plant.
     ......................
     ......................
     .........*............
     .........#............
     .........##*.......... here's the same plant one turn after
     .........#............ sunlight hits it.
     .........*............
     ......................
     ...*...*.*.*##........
     ...#...#.#...#........ and the same plant after several turns.
     ...#...#.######*...... 
     ...#...#.#.#.......... (algo: each turn, pick one end section. 
     ...#######.####*...... it has a separate 50% chance to grow in
     .......#.....#........ each valid direction. always 2 tiles at a
     .......##*...*........ time.)
     ......................
     ...................... (when sunlight goes away, reverse it like
     ...................... this: each turn, pick one end section.
     ...................... find the stalk it's connected to and remove
     ...................... the plant 2 spaces in that direction. if
     ...................... the 2nd one has only one stalk adjacent, it
     ...................... becomes an end section.)
     ...................... ------------------
     ........****.......... poppies! spend 3 turns in them and you get hit with magical drowsiness.
     ......*******......... it only lasts for a few turns, but refreshes itself as long as you're in the poppies.
     .....******........... ------------------
     .....*****............ from brogue: dense foliage that you can
     ......................  trample.
     ...................... ------------------
     ....,,,,,..,,,,....... glowing fungus patches
     ....,,,,,,,,,,........ 
     ..........,,,.,....... 





fix Parabola: Redraw(), and everything else, shouldn't draw in the last screen position.



okay, I did the automatic r/c/N/E/v/h/i function. it works great, but the corner definition should be updated to allow 2x2 rooms, basically. this allows corners to touch. also, edge definition should allow 2x3 rooms:
cEc
cEc
	-this won't be used at all until I have nonrectangular rooms


room shapes:
rectangular
  min: 3x3
elliptical
  min: 5x5
diamond
  min: 5x5
triangular
  min: 5x5
L-shaped
  min: 6x6
cross-shaped
  min: 7x7
alcoves(2x2 holes on sides of room)
  min: 9x9

room features:
pillars in various configurations. basic guidelines: no 2 pillars should touch, &
	rooms should be symmetrical in at least one dimension.
	explicit pillar rules! find the dimensions of the 'pillar matrix' - the
	largest arrangement of pillars that can fit in a single(say, the top-left)
	quadrant of a room. Then, fill randomly, respecting the rule "no staggered
	pillars, such as #.  .# ". If the dimension is divisible by 4, you can add an
	offset of 0 or 1 in that dimension. Then, simply reflect to fill the room.
	an 11x11 room has a 3x3 matrix, a 15x22 room has 4x5, and 3x3 has 1x1.
   -don't use the above method just yet. for now, either make 1 pillar in each
	quadrant, or tile it fully.
rooms with walls in the center. should leave at least 2 spaces on each side.


	########	########	########	     ###
	#......#	##....##	###..###	    ##N#
	#......#	#......#	##....##	   ##NN#
	#......#	#......#	#......#	  ##NNE#
	#......+	#......+	#......+	 ##NNrE+
	#......#	#......#	##....##	##NNrrE#
	#......#	##....##	###..###	#NNEEEc#
	##+#####	##+#####	##+#####	##+#####
							


	########	########	########	########
	#......#	#......#	#......#	###..###
	#......#	#.#..#.#	#......#	###..###
	#......#	#......#	#..##..#	#......#
	####...+	#......+	#..##..+	#......+
	 3x3...#	#.#..#.#	#......#	###..###
	   #...#	#......#	#......#	###..###
	   #####	##+#####	##+#####	##+#####
	at least 3x3?					


bigger!

	#############	#############	#############	#############
	#####...#####	######.######	#...........#	#######.....#
	###.......###	#####...#####	##..........#	#######.....#
	##.........##	####.....####	###.........#	#######.....#
	##.........##	###.......###	####........#	#######.....#
	#...........#	##.........##	#####.......#	#...........#
	#...........#	#...........#	######......#	#...........#
	#...........#	##.........##	#######.....#	#...........#
	##.........##	###.......###	########....#	#...........#
	##.........##	####.....####	#########...#	#...........#
	###.......###	#####...#####	##########..#	#...........#
	#####...#####	######.######	###########.#	#...........#
	#############	#############	#############	#############
		       4 possible doors 


	#############	#############	#############	#############
	#...........#	#...........#	#...........#	###.##.##.###
	#...........#	#.#.#...#.#.#	#...........#	###.##.##.###
	#...........#	#...........#	#...........#	#...........#
	#...........#	#.#.......#.#	#...#####...#	###.......###
	#...........#	#...........#	#...#####...#	###.......###
	#.....#.....#	#...........#	#...#####...#	#...........#
	#...........#	#...........#	#...#####...#	###.......###
	#...........#	#.#.......#.#	#...#####...#	###.......###
	#...........#	#...........#	#...........#	#...........#
	#...........#	#.#.#...#.#.#	#...........#	###.##.##.###
	#...........#	#...........#	#...........#	###.##.##.###
	#############	#############	#############	#############
							no, see below.

	    #####	     ###	#############	      #######
	  ###...###  	    ##.##	#...........#	      #.....#
	 ##.......## 	   ##...##	##..........#	      #.....#
	 #.........# 	  ##.....##	 ##.........#	      #.....#
	##.........##	 ##.......##	  ##........#	#######.....#
	#...........#	##.........##	   ##.......#	#...........#
	#...........#	#...........#	    ##......#	#...........#
	#...........#	##.........##	     ##.....#	#...........#
	##.........##	 ##.......##	      ##....#	#...........#
	 #.........# 	  ##.....##	       ##...#	#...........#
	 ##.......## 	   ##...##	        ##..#	#...........#
	  ###...###  	    ##.##    	         ##.#	#...........#
	    #####    	     ###     	          ###	#############


	#############	  #########  
	#...........#	  #.##.##.#  
	#...........#	###.##.##.###
	#...........#	#...........#
	#...#####...#	###.......###
	#...#   #...#	###.......###
	#...#   #...#	#...........#
	#...#   #...#	###.......###
	#...#####...#	###.......###
	#...........#	#...........#
	#...........#	###.##.##.###
	#...........#	  #.##.##.#  
	#############	  #########  
			no, use the one below:
	#############	#############
	#...........#	###..###..###
	#...#...#...#	###..###..###
	#...........#	#...........#
	#...#.#.#...#	#...........#
	#...........#	###.......###
	#.#.#...#.#.#	###.......###
	#...........#	###.......###
	#...#.#.#...#	#...........#
	#...........#	#...........#
	#...#...#...#	###..###..###
	#...........#	###..###..###
	#############	#############
			much better!


	########################
	#......................#
	#.#..................#.#
	#......................#
	#.#.#...#......#...#.#.#
	#......................#
	#......................#
	#......................#
	#.#.......#..#.......#.#
	#......................#
	#......................#
	#......................#
	#.#.#...#......#...#.#.#
	#......................#
	#.#..................#.#
	#......................#
	########################


not yet:
traps incl. on chests and doors, or alarms on items.
double doors for fortresses - easy
candlelit altar. like a solid fire pit. maybe radius 2.
torches
mirrors
levers
wind (works like conveyors)
rocks
mud
bombable walls
tunnels that allow travel to possibly-disconnected parts of the level. would remove you from the map for several turns. 


single-use (or one-way) corridors
2- and 3-wide corridors, with possible statues or other features

round rooms
diamond rooms
triangular rooms
rooms with rectangular sections missing from a corner (the easy way to do 'combined' rooms)
rooms that aren't carved out in the middle (i.e. a large central 'pillar')
'starburst' rooms, maybe
unangband's overlapping rooms: 2 random rectangles within a larger one.
this type of room: (even dimensions in both directions, and at least 6x6)
  ########  
  #..##..#  		  ####
###..##..###		 ##..##
+..........#		###..###
#..........#		#......#
###......###		+..@...#
###......###		###..###
#..........####		 ##..##
#.............		  #.##
###......######		  #.#
###......###		  # #
#..........#
#..........#
###..##..###
  #..##..#  
  ########  


slime levels: lots of elliptical rooms. pools and streamers/trails of slime. fog or poison gas vents. enemy type: slimes or slug-men or something

hive levels: 3x3 rooms only, no doors. corridor numbers 4 4 1 4 4. GenerateInitial, then generate (50/50) rooms and corridor chains, 700 times. Do standard cleanup and verification. enemy type: some kind of insect, or hive dogs
	-no firepits, fire geysers, ....

fog levels: ???. lots of fog vents. enemy type: phantoms. (probably spawns 2-3 phantoms for every replaced monster)

mine levels: normal levels turned into caves. rubble. enemy type: kobolds.

fortress levels. big central hall, more ordered rooms and corridors. possibly symmetric.

opulent levels. lots of statues. pools of water? long (dead-end) halls?

more: moving parts? corridor features? carve rooms for chests in caves?





leveltype-specific monsters that can only appear in the proper "biome"

don't increase in power, but rather in number.


items you can only find on certain level types?



levelgen:
what sort of separations? would a level have only 2 'types'?
what about 'templates' in the form of functions that could be applied, like 'ruined'?



include a goal at the start	-	"None of the other scouts returned." etc


brutish strength
	-smash known traps, stalagmites, doors, statues. anything useful?
  no items, spells, or certain feats, but lots of damage and the ability to smash
  doors, statues, and other features?
explosive fungus orb-type item? or orcish grenades?


orc assassin needs an AI enhancement: when moving toward the player, if there is a spot that the player can't see (but it's at the same distance as the spot you would have stepped to), step there to stay out of sight.

a stronger noxious worm would burrow into a wall and koolaid out when the player walks by



new monsters:
slugman
  appears in groups. leaves slime trails on the ground. usually moves slowly, but
  moves quickly when on a slime trail. ranged attack, maybe?
(on-death triggers? light, knockback?)
(anything that doesn't care about how much damage you deal)


new dungeon features:
trapped chests or doors?
torches
	-implemented as walls that actually shed light from an adjacent tile?
alarms tied to items or doors?
periodic stun trap that affects everything in its LOS
bombable walls to hide some hidden rooms.
more open areas. maybe even LoL-style brush?
  open areas make carrying a torch more dangerous, and make lightning bolt better
beamos-inspired mob/trap/feature. probably mounted in the wall. might hit an
  entire direction instead of just a line.
round rooms
any other active dungeon elements or 'moving parts'
some other features that can be found in corridors.
deity statues. these would be colored instead of gray, and would have an associated event and terrain effect. the event simply checks the area and prints the appropriate descriptive message, then stops. the terrain effect depends on which type of statue it is. flat bonus to that skill? no, probably just set it to 10. that would lead to rooms where it's easy to hit & damage, rooms where it's hard to hit, rooms where magic is easy, rooms where magical/supernatural effects are diminished, and rooms where everything is stealthy. are there other good effects besides these?
anyway, these would appear near the center of rooms, and could replace the walls between shrines.
One-way and/or single-use corridors. (thanks to .orphle. in #br.gue)
sometimes, monsters should actually guard corridors

other:
an event (possibly triggered by shrines or chests) where you defend an area for a
  short while, for some purpose.
blind-in-darkness status to go with damaged-in-light.


#

considering a 'slimed' status that would put out fires but leave you clumsy or something. fire melts ice, ice freezes slime, slime douses fire. slime traps, slime enemies, slime orbs that you can employ to extinguish fires on yourself.
	-being on fire makes you immune to freezing, being frozen makes you immune to slime, and being slimed makes you immune to burning? sounds decent.
	-then i would add slime orb and orb of burning at the same time.
being slimed could give you a 50% chance to drop items rather than use them.

i think i've figured out slime:
	-any fire damage or catching fire breaks FROZEN.
	-any cold damage or being frozen breaks SLIMED.
	-FROZEN makes you immune to being SLIMED. SLIMED makes you immune to being on fire.
		being on fire makes you immune to being frozen.
	-walking on slime fails 1/3 of the time. The effect is identical to being stunned, 
		except that the message is "you slide" instead of "you stagger"
	-attacking on slime has a 1/3 chance of making you fall into the slime. this doesn't
		affect your attack, nor does it take time to stand up, but it SLIMES you.
	-while SLIMED, any item you try to use has a 50% chance to be dropped instead. evil!

             
#

probably split all these into 0.7.1+ and 0.8.0.
then 0.9.0 can have special levels, and 1.0.0 will be the final iteration.
	-equipment update: better identities for weapons and armor. chainmail would resist slashing, 
		weapons would have different crit effects, plate would ... etc

		new terrain
		other balance changes
		and help check

-for the next version: item descriptions, slime and fog levels, leveltype-specific monsters, circular, diamond, and L-shaped rooms

in ForaysSuperClass: public ActorType ZOMBIE = ActorType.ZOMBIE;


things to do between 0.5 and 1.0:

at least 1 special level per game, with an appropriate number of different special levels
	-cave of bats

animations should support the concept of a 'viewer' - cells outside viewer's FOV don't animate.

generate trolls with rocks they can throw, in a lair, and have them stay in that lair.

consider making ranged attacks...not attacks at all, but generated straight from the AI routine

Select() needs a rewrite, and to be moved out of Actor.

mirrors: can be generated when there is solid rock behind a wall.
		-or, if I wanted to generate them anywhere, I could have a can_be_reflection thing.
			then what you see depends on where you stand.
	-they just show what is opposite them. doesn't show vampires. doesn't show the player's reflection 
		if the player is shadow cloaked.

partial classes to separate AI from the rest of Actor
foreach(int i in FourDirections) or foreach(int i in Dir8). 4, 8, and 9.

option to put stat window on right.

f-spells should be expanded to spells AND feats.

"you fade away in the darkness" should also appear when you put your torch away while shadow cloaked.

lots more magic items, to improve character differentiation?
joff's idea: more than 20 spells, of which a subset of 20 is chosen for each game.
radiance/incandescence: target light source deals Xd6 damage to enemies within its light radius.
0.7.1+ should have:

"You are burned. You are unburnt." <--being attacked by burning enemy while Tough
think about scaling Spirit's duration reduction to more than 50%
what about a 'default ranged attack' in addition to the 'default melee attack' spell?
potion of vampirism? life drain, light allergy, flying. this would be a nice addition to an ID game, at least.
things other than the player should be able to call MakeNoise
extend the "monster notices" sounds so that you can hear them even if you can't see them.
	-this would make a good candidate for generalization: printing a message if the player can see an object OR if that object is within a certain distance. perhaps a distance that implies that the message is a sound, not a visual.


bugs: 
this bug PROBABLY exists, even if I haven't noticed it yet: If you move to a new level and end up in the same spot, the map will lose track of you until you move because the position is cleared last.
here's that really weird one where I got killed the turn I used a rune of time:
"Time stops for a moment. (grayed out)
You bring out your torch. The troll seer regenerates. The troll
seer casts glacial blast. The glacial blast hits you. You [more]
die. [more]"
visual bug for lightning bolt: when targeting past the target to hit it at an angle (when it's in a doorway, say), the bolt seems to go through walls.
minor: passage shows a WHITE floor under the player, not the correct color.
using lunge on an aware goblin archer a knight's move away. the archer appears normal, when it should have a green background from the targeting.
	-i believe this is another form of the other background color bug.
	-linux or win?
	-does not happen every time. this one might be a pain to track down.
again on linux - bits of the previous map still appear. no idea why. does not happen often. (once so far!)
	-not reproduced yet
"The skeleton looks less disoriented. " - no skeleton in sight.
	-reviewed code. should never happen, but it did.
		-theory: it died and the message was still printed. rework removal from msg_obj list.
			-happened again with "the skeleton looks more stable". debug the trap messages, then do the msg_obj fix.
		-above theory is probably wrong: happened with a goblin that was alive
"You fire an arrow. The arrow hits the cultist. The cultist [more]
dies."
	-note that the [more] takes up exactly as much space as "dies. " - what gives?
	-should be fixed!



--generate the list of monsters first, THEN generate the level. then verify that i.e. a troll has a proper lair.



room mimic
	-how is this going to work? perhaps it's usually generated at the end of a longish corridor, so blinking out is harder to do.
	-it shouldn't ACTUALLY prevent teleportation escapes, though. a quick Passage out is probably just the thing.
	-perhaps some kind of interactive 'don't stand here' thing.
	-so, the event checks every several turns to see if the player is within its area(which is the entire room)
	-if this happens, it either sets some state, or spawns another event type to check again a few turns later(remember, there's a chest in here)
		-how about a good chance of an extra item or two, as well?
			-EITHER 1d3 items OR a chest?
		-wait, why not trigger on the chest, also? both will work great.
	-when the mimic has been disturbed, a message is printed, the membrane/door starts to close, and acid starts to fall.
		-and some of the walls and floor turn to red?
	-i think the average distance from chest to door will be like 3, so probably 2d2 turns.
	-if the player is on the door when it closes, he takes some damage and becomes immobilized. (and can then escape)
	-otherwise, the door becomes a membrane (would be great if certain terrain had ATTACKABLE flag, yeah?) with an okay amount of HP.
	-all the while, every 1d3 turns acid drops onto the floor from the ceiling - this is delayed by 1 turn, so it doesn't hit the player directly.
		-lasts for 1d3+3 turns or so
	-standing in the acid deals damage, of course.
	-ALSO, to prevent the player from simply dancing around until he gets out...the room should probably either shrink, or be subject to an area attack.
		-a crushing attack is way easier. lowish damage, i suppose.
	-annnnd, when the player escapes, the membrane soon returns to its door form and the walls and floors to their normal colors.

	-first, i need terrain for acid and membrane, no problem.
	-and an event for 'spawn acid here', no prob
	-now, what state do i need to track? the event already tracks the area, no problem.
		-'player inside room' - the first trigger. unneeded if i trigger only on the chest.
		-state for 'disturbed', of course
		-'number of turns until membrane closes'
		-state for membrane: closing, crushing, closed.
		-'number of turns until next acid attack'
		-'number of turns until next crushing attack'
		-'membrane has been destroyed' - could also just mean it's dead, and remove the event.

idea for the cultist's special level: a receptacle fills as cultists die to fire damage. you don't want it to fill up.
special level: giant pangolins tear open giant termite mounds. the pangolins use their armor to avoid harm as the termites swarm you.
battle of the titans special level: a brawl between titans that don't care about you. avoid being stepped on or destroyed by AOEs.
 <.agikm.> Maybe some wormlike creatures that would merge together and create more powerful variant of the same thing.
 <.agikm.> So you'd better just kill them one by one fast.
special level brainstorm idea dump:
skeleton jelly. hilarious.


voltaic rapture was too badass
-this spell wasn't voltaic rapture, but was lightning-based: each time you're hit in melee you release a radius 2 burst of electricity

trap disarming that simply requires different actions. One requires you to '.' wait on 2 opposite sides. One requires you to run around it without stopping. One requires you to step on all the diagonals without stepping on any of the cardinal directions.
                                                   

secrets
silence
mystery
concealment

onslaught
battle
conflict
assault

protection
security
shielding
warding

heart
energy
will
essence

wizardry
sorcery
conjuring
evocation


